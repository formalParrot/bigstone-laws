---
layout: home
title: "Events"
---

<!-- Filter Buttons + Search -->
<div class="event-controls">
  <button id="filterFinished">Finished</button>
  <button id="filterNotFinished">Not Finished</button>
  <input type="text" id="searchInput" placeholder="Search events...">
</div>

<ul id="events">
  {% assign sorted_cases = site.cases | sort: "date" %}
  
  {% for case in sorted_cases %}
    {% if case.event-happen == true %}
      <li class="court-event {% if case.event-status == 'finished' %}is-finished{% elsif case.event-status == 'in-progress' %}is-in-progress{% else %}is-not-finished{% endif %}">
        <div class="court-event-container">

          <!-- Left: Info -->
          <div class="court-event-info">
            {% if case.event-date %}
              <div class="event-date-badge">
                <time class="event-time" datetime="{{ case.event-date | date_to_xmlschema }}">
                  {{ case.event-date | date: "%b %d, %Y %H:%M %Z" }}
                </time>
              </div>
            {% endif %}

            <h2 class="court-event-title">{{ case.title }}</h2>
            <h6><a href="{{ case.url | relative_url }}">Case File</a></h6>

            {% if case.event-status == "finished" %}
              <span class="status finished">Finished</span>
            {% elsif case.event-status == "in-progress" %}
              <span class="status in-progress">In Progress</span>
            {% else %}
              <span class="status not-finished">Not finished</span>
            {% endif %}

            {% if case.judge %}
              <p><strong>Judge:</strong> {{ case.judge }}</p>
            {% endif %}
            {% if case.plaintiff and case.defendant %}
              <p><strong>Parties:</strong> {{ case.plaintiff }} vs {{ case.defendant }}</p>
            {% endif %}
            {% if case.reason %}
              <p class="event-reason"><strong>Reason:</strong> {{ case.reason }}</p>
            {% endif %}
            {% if case.verdict %}
              <p class="event-verdict"><strong>Verdict:</strong> {{ case.verdict }}</p>
            {% endif %}
          </div>

          <!-- Right: Image -->
          <div class="court-event-image">
            {% if case.event-image %}
              <img src="{{ case.event-image | relative_url }}" alt="Event image">
            {% else %}
              <img src="assets/cases/default-banner.png" alt="Default event image">
            {% endif %}
          </div>

        </div>
      </li>
    {% endif %}
  {% endfor %}
</ul>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // Format dates
  document.querySelectorAll("time.event-time").forEach(el => {
    const dt = new Date(el.getAttribute("datetime"));
    el.textContent = dt.toLocaleString([], {
      year: "numeric",
      month: "short",
      day: "numeric",
      hour: "2-digit",
      minute: "2-digit",
      timeZoneName: "short"
    });
  });

  const searchInput = document.getElementById("searchInput");
  const events = document.querySelectorAll("#events .court-event");
  const btnFinished = document.getElementById("filterFinished");
  const btnNotFinished = document.getElementById("filterNotFinished");
  const eventsList = document.getElementById("events");

  // --- Search Filter ---
  searchInput.addEventListener("input", () => {
    const term = searchInput.value.toLowerCase();
    events.forEach(event => {
      const text = event.innerText.toLowerCase();
      event.style.display = text.includes(term) ? "" : "none";
    });
  });

  // --- Button Filters ---
  btnFinished.addEventListener("click", () => {
    events.forEach(event => {
      if (event.classList.contains("is-finished")) {
        event.style.display = "";
      } else {
        event.style.display = "none";
      }
    });
  });

  btnNotFinished.addEventListener("click", () => {
    events.forEach(event => {
      if (event.classList.contains("is-not-finished") || event.classList.contains("is-in-progress")) {
        event.style.display = "";
      } else {
        event.style.display = "none";
      }
    });
    sortInProgressTop();
  });

  // --- Auto sort: in-progress to top ---
  function sortInProgressTop() {
    const items = Array.from(eventsList.children);
    items.sort((a, b) => {
      const aProg = a.classList.contains("is-in-progress") ? 1 : 0;
      const bProg = b.classList.contains("is-in-progress") ? 1 : 0;
      return bProg - aProg; // if b is in-progress, it goes before a
    });
    items.forEach(item => eventsList.appendChild(item));
  }
  // Run once at start
  sortInProgressTop();
});
</script>

<style>

.event-controls {
  display: flex;
  gap: 0.5rem;
  margin: 1rem 0 2rem 0;
  align-items: center;
}
.event-controls button {
  padding: 0.5rem 1rem;
  border: 1px solid #ddd;
  border-radius: 8px;
  background: #f9f9f9;
  cursor: pointer;
  transition: background 0.2s;
}
.event-controls button:hover {
  background: #eee;
}
.event-controls input {
  flex: 1;
  padding: 0.5rem 1rem;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-size: 1rem;
}

.court-event.is-finished {
  opacity: 0.7;
}

.court-event {
  list-style: none;
  margin-bottom: 2rem;
  border: 1px solid #ddd;
  border-radius: 10px;
  padding: 1rem;
  background: #f9f9f9;
  position: relative;
}
.court-event-container {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 1rem;
}
.court-event-info {
  flex: 1;
}
.event-date-badge {
  font-weight: bold;
  background: #007acc;
  color: white;
  padding: 0.3rem 0.6rem;
  border-radius: 5px;
  display: inline-block;
  margin-bottom: 0.5rem;
}
.court-event-title {
  margin: 0 0 0.5rem 0;
}
.status {
  display: inline-block;
  padding: 0.2rem 0.5rem;
  border-radius: 5px;
  font-size: 0.85rem;
  margin-bottom: 0.5rem;
}
.status.finished { background: #d4edda; color: #155724; }
.status.in-progress { background: #fff3cd; color: #856404; }
.status.not-finished { background: #f8d7da; color: #721c24; }
.court-event-image img {
  max-width: 200px;
  border-radius: 8px;
}
</style>
